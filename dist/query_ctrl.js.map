{"version":3,"sources":["../src/query_ctrl.js"],"names":["QueryCtrl","DEFAULT","CicadaDatasourceQueryCtrl","$scope","$injector","scope","target","type","device_id","varbind_id","device_tag","varbind_tag","datasource","getDeviceList","then","device_list","map","e","Object","text","name","value","id","isNaN","getVarbindList","varbind_list","filter","v","is_history","getDeviceTags","tag_list","getVarbindTags","self","panelCtrl","refresh","templateUrl"],"mappings":"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","file":"query_ctrl.js","sourcesContent":["import {QueryCtrl} from 'app/plugins/sdk';\n\nvar DEFAULT = '* select *';\n\nexport class CicadaDatasourceQueryCtrl extends QueryCtrl {\n\n\tconstructor($scope, $injector) {\n\t\tsuper($scope, $injector);\n\t\n\t\tthis.scope = $scope;\n\t\tthis.target.type = this.target.type || 'single';\n\t\tthis.target.device_id = this.target.device_id || DEFAULT;\n\t\tthis.target.varbind_id = this.target.varbind_id || DEFAULT;\n\t\tthis.target.device_tag = this.target.device_tag || 'All';\n\t\tthis.target.varbind_tag = this.target.varbind_tag || DEFAULT;\n\t}\n\n\tgetDeviceList() {\n\t\treturn this.datasource.getDeviceList().then((device_list) => device_list.map((e) => new Object({text: e.name, value: e.id})));\n\t}\n\n\tgetVarbindList() {\n\t\treturn isNaN(this.target.device_id) ?\n\t\t\t[{value: DEFAULT, text: DEFAULT}] :\n\t\t\tthis.datasource.getVarbindList(this.target.device_id)\n\t\t\t\t.then((varbind_list) => varbind_list.filter((v) => v.is_history).map((e) => new Object({text: e.name, value: e.id})));\n\t}\n\n\tonDeviceChange() {\n\t\tthis.target.varbind_id = DEFAULT;\n\t}\n\n\tgetDeviceTags() {\n\t\treturn this.datasource.getDeviceTags()\n\t\t\t.then((tag_list) => tag_list.map((e) => new Object({text: e, value: e})));\n\t}\n\n\tgetVarbindTags() {\n\t\treturn this.datasource.getVarbindTags(this.target.device_tag)\n\t\t\t.then((tag_list) => tag_list.map((e) => new Object({text: e, value: e})));\n\t}\n\n\tonDeviceTagChange() {\n\t\tvar self = this;\n\t\tthis.datasource.getVarbindTags(this.target.device_tag).then(function(tag_list) {\n\t\t\tself.target.varbind_tag = tag_list[0] || DEFAULT;\n\t\t\tself.panelCtrl.refresh();\n\t\t});\n\t}\n}\n\nCicadaDatasourceQueryCtrl.templateUrl = 'partials/query.editor.html';"]}